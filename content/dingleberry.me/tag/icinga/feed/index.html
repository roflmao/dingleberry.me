<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>dingleberry.me &#187; dingleberry.me &#8211; technical blog shit</title>
	<atom:link href="http://dingleberry.me/tag/icinga/feed/" rel="self" type="application/rss+xml" />
	<link>http://dingleberry.me</link>
	<description>technical blog shit</description>
	<lastBuildDate>Fri, 06 Jun 2014 17:38:05 +0000</lastBuildDate>
	<language>en-US</language>
		<sy:updatePeriod>hourly</sy:updatePeriod>
		<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=3.8.1</generator>
	<item>
		<title>Running nagios-plugins via saltstack</title>
		<link>http://dingleberry.me/2013/11/running-nagios-plugins-via-saltstack/</link>
		<comments>http://dingleberry.me/2013/11/running-nagios-plugins-via-saltstack/#comments</comments>
		<pubDate>Tue, 26 Nov 2013 11:15:25 +0000</pubDate>
		<dc:creator><![CDATA[morten]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>
		<category><![CDATA[icinga]]></category>
		<category><![CDATA[monitoring]]></category>
		<category><![CDATA[nagios]]></category>
		<category><![CDATA[salt]]></category>
		<category><![CDATA[saltstack]]></category>

		<guid isPermaLink="false">http://dingleberry.me/?p=715</guid>
		<description><![CDATA[I&#8217;m so sick of maintaining NRPE-config on my servers, and I dont really want root-sshkeys all over the place. Recently I discovered saltstack and started to play with it a bit. I came up with the idea of running Nagios(or Icinga) on the same server as my salt-master and so I created a little wrapper [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>I&#8217;m so sick of maintaining NRPE-config on my servers, and I dont really want root-sshkeys all over the place. Recently I discovered saltstack and started to play with it a bit. I came up with the idea of running Nagios(or Icinga) on the same server as my salt-master and so I created a little wrapper that lets me run nagios-checks via saltstack.</p>
<p>Here&#8217;s how it works.</p>
<p>This is my little wrapper-script written in python: <a title="https://github.com/mortis1337/nagios-plugins/blob/master/check_by_salt.py" href="https://github.com/mortis1337/nagios-plugins/blob/master/check_by_salt.py">https://github.com/mortis1337/nagios-plugins/blob/master/check_by_salt.py</a></p>
<p>The wrapper takes hostname, plugin and a timeoutvalue as arguments:</p>
<p>$ python check_by_salt.py -H examplehost -p &#8220;/path/to/existing/nagiosplugin arg1 arg2&#8243; -t 10</p>
<p>The wrapper imports salt and runs commands on minions with cmd.run_all and returns the output and the exitcode.</p>
<p>For this to work as the nagios/icinga user, you will have to configure the client_acl for the user in the salt-master config, so go ahead and edit the master-configfile (default: /etc/salt/master)</p>
<p>Search for &#8220;client_acl&#8221; in the file and add this :</p>
<p>client_acl:<br />
icinga:<br />
- cmd.*</p>
<p>Yeeaaaap, thats quite the security risk right there, but read up on how to limit what can be done with the cmd-state in salt and atleast it will be safer than using ssh-keys <img src="http://dingleberry.me/wp-includes/images/smilies/icon_smile.gif" alt=":)" class="wp-smiley" /> </p>
<p>check_by_salt in combination with <a title="https://github.com/mortis1337/nagios-plugins/blob/master/check_disk_generic.py" href="https://github.com/mortis1337/nagios-plugins/blob/master/check_disk_generic.py">https://github.com/mortis1337/nagios-plugins/blob/master/check_disk_generic.py</a> will instantly give you monitoring of all your disks with no clientside-configuration.</p>
<p>Use it if you like it and feel free to improve it.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content:encoded>
			<wfw:commentRss>http://dingleberry.me/2013/11/running-nagios-plugins-via-saltstack/feed/</wfw:commentRss>
		<slash:comments>4</slash:comments>
		</item>
	</channel>
</rss>
